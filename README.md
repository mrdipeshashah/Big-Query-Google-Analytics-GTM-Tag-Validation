This query is built on the foundations of how tags are set-up in Google Tag Manager. I have provided a link to a GTM container in GitHub that will provide the strcuture to use this Big Query GA4 code. The query is built around the following event parameters which are set-up in the tag: container_id, container_version, tag_name, tag_category and tag_date_creation
